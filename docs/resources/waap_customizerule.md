---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "wangsu_waap_customizerule Resource - wangsu"
subcategory: "Security"
description: |-
    Use this resource to create a custom rule.
    This resource allows you to create a custom rule.
---

# wangsu_waap_customizerule (Resource)

Use this resource to create a custom rule.
This resource allows you to create a custom rule.

## Example Usage

```hcl
resource "wangsu_waap_customizerule" "demo" {
  rule_name   = "tf_test_u"
  domain      = "waap.test30.com"
  description = "terraform test update"
  #   scene = "WEB"
  scene  = "API"
  api_id = "1800805524845170689"
  act    = "BLOCK"

  condition {
    path_conditions {
      match_type = "EQUAL"
      paths      = ["/p11", "/p21"]
    }
    uri_param_conditions {
      match_type  = "NOT_EQUAL"
      param_name  = "p1"
      param_value = ["pv1", "pv2"]

    }
    area_conditions {
      match_type = "NOT_EQUAL"
      areas      = ["AI", "AU"]
    }
    method_conditions {
      match_type     = "NOT_EQUAL"
      request_method = ["GET", "POST"]
    }
    header_conditions {
      match_type = "NOT_EQUAL"
      key        = "hk1"
      value_list = ["h1", "h2"]
    }
    ja3_conditions {
      match_type = "NOT_EQUAL"
      ja3_list   = ["ja312345678901234567890123456788", "ja322345678901234567890123456788"]
    }
    ja4_conditions {
      match_type = "NOT_EQUAL"
      ja4_list   = ["ja41740600_c43983326036_1b2d6ce873a3", "ja42740600_c43983326036_1b2d6ce873a3"]
    }
  }
}


data "wangsu_waap_customizerule" "demo" {
  rule_name   = wangsu_waap_customizerule.demo.rule_name
  domain_list = [wangsu_waap_customizerule.demo.domain]
}

output "customizerule_list" {
  value = data.wangsu_waap_customizerule.demo
}
```


<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `act` (String) Action.<br/>
NO_USE:Not Used<br/>
LOG:Log<br/>
DELAY:Delay<br/>
BLOCK:Deny<br/>
RESET:Reset Connection
- `condition` (Block List, Min: 1) Match Conditions. (see [below for nested schema](#nestedblock--condition))
- `domain` (String) Hostname.
- `rule_name` (String) Rule Name, maximum 50 characters.<br/>
does not support # and & .
- `scene` (String) Protected target.<br/>
WEB:Website<br/>
API:API

### Optional

- `api_id` (String) API ID under API business, multiple separated by ; sign.<br/>
When the protected target is APIThis field is required.
- `description` (String) Description, maximum 200 characters.

### Read-Only

- `id` (String) Rule ID.

<a id="nestedblock--condition"></a>
### Nested Schema for `condition`

Optional:

- `area_conditions` (Block List) Geo, match type cannot be repeated. (see [below for nested schema](#nestedblock--condition--area_conditions))
- `header_conditions` (Block List) Request Header, match type can be repeated. (see [below for nested schema](#nestedblock--condition--header_conditions))
- `ip_or_ips_conditions` (Block List) IP/CIDR, match type cannot be repeated. (see [below for nested schema](#nestedblock--condition--ip_or_ips_conditions))
- `method_conditions` (Block List) Request Method.<br/>
When the business scenario is API,this matching condition is not supported. (see [below for nested schema](#nestedblock--condition--method_conditions))
- `path_conditions` (Block List) Path, match type cannot be repeated.<br/>
When the business scenario is API, this matching condition is not supported. (see [below for nested schema](#nestedblock--condition--path_conditions))
- `referer_conditions` (Block List) Referer, match type cannot be repeated. (see [below for nested schema](#nestedblock--condition--referer_conditions))
- `ua_conditions` (Block List) User Agent, match type cannot be repeated. (see [below for nested schema](#nestedblock--condition--ua_conditions))
- `uri_conditions` (Block List) URI, match type cannot be repeated.<br/>
When the business scenario is API, this matching condition is not supported. (see [below for nested schema](#nestedblock--condition--uri_conditions))
- `uri_param_conditions` (Block List) URI Parameter, match type cannot be repeated.<br/>
When the business scenario is API, this matching condition is not supported. (see [below for nested schema](#nestedblock--condition--uri_param_conditions))
- `ja3_conditions` (Block List) JA3 Fingerprint, match type cannot be repeated. (see [below for nested schema](#nestedblock--condition--ja3_conditions))
- `ja4_conditions` (Block List) JA4 Fingerprint, match type cannot be repeated. (see [below for nested schema](#nestedblock--condition--ja4_conditions))

<a id="nestedblock--condition--area_conditions"></a>
### Nested Schema for `condition.area_conditions`

Required:

- `areas` (List of String) Geo.
- `match_type` (String) Match type.<br/>
EQUAL:Equal<br/>
NOT_EQUAL:Does not equal


<a id="nestedblock--condition--header_conditions"></a>
### Nested Schema for `condition.header_conditions`

Required:

- `match_type` (String) Match type.<br/>EQUAL: Equals, user agent case sensitive<br/>NOT_EQUAL: Does not equal, user agent case sensitive<br/>CONTAIN: Contains, user agent case insensitive<br/>NOT_CONTAIN: Does not Contains, user agent case insensitive<br/>NONE:Empty or non-existent<br/>REGEX: Regex match, user agent case insensitive<br/>NOT_REGEX: Regular does not match, user agent case insensitive<br/>START_WITH: Starts with, user agent case insensitive<br/>END_WITH: Ends with, user agent case insensitive<br/>WILDCARD: Wildcard matches, user agent case insensitive, * represents zero or more arbitrary characters, ? represents any single character<br/>NOT_WILDCARD: Wildcard does not match, user agent case insensitive, * represents zero or more arbitrary characters, ? represents any single character
- `key` (String) Header name,case insensitive,up to 100 characters.<br/>Example: Accept.
- `value_list` (List of String) Header value.<br/>When the match type is REGEX/NOT_REGEX, only one value is allowed.


<a id="nestedblock--condition--ip_or_ips_conditions"></a>
### Nested Schema for `condition.ip_or_ips_conditions`

Required:

- `match_type` (String) Match type.<br/>EQUAL:Equal<br/>NOT_EQUAL:Does not equal
- `ip_or_ips` (List of String) IP/CIDR, maximum 300 IP/CIDR.


<a id="nestedblock--condition--method_conditions"></a>
### Nested Schema for `condition.method_conditions`

Required:

- `match_type` (String) Match type.<br/>
EQUAL:Equal<br/>
NOT_EQUAL:Does not equal
- `request_method` (List of String) Request method.<br/>
Supported values: GET/POST/DELETE/PUT/HEAD/OPTIONS/COPY.


<a id="nestedblock--condition--path_conditions"></a>
### Nested Schema for `condition.path_conditions`

Required:

- `match_type` (String) Match type.<br/>EQUAL: Equals, user agent case sensitive<br/>NOT_EQUAL: Does not equal, user agent case sensitive<br/>CONTAIN: Contains, user agent case insensitive<br/>NOT_CONTAIN: Does not Contains, user agent case insensitive<br/>REGEX: Regex match, user agent case insensitive<br/>NOT_REGEX: Regular does not match, user agent case insensitive<br/>START_WITH: Starts with, user agent case insensitive<br/>END_WITH: Ends with, user agent case insensitive<br/>WILDCARD: Wildcard matches, user agent case insensitive, * represents zero or more arbitrary characters, ? represents any single character<br/>NOT_WILDCARD: Wildcard does not match, user agent case insensitive, * represents zero or more arbitrary characters, ? represents any single character
- `paths` (List of String) Path.<br/>When match type is EQUAL/NOT_EQUAL/START_WITH/END_WITH, path needs to start with "/", and no parameters.<br/>When the match type is REGEX/NOT_REGEX, only one value is allowed. <br/>Example: /test.html.


<a id="nestedblock--condition--referer_conditions"></a>
### Nested Schema for `condition.referer_conditions`

Required:

- `match_type` (String) Match type.<br/>EQUAL: Equals, user agent case sensitive<br/>NOT_EQUAL: Does not equal, user agent case sensitive<br/>CONTAIN: Contains, user agent case insensitive<br/>NOT_CONTAIN: Does not Contains, user agent case insensitive<br/>NONE:Empty or non-existent<br/>REGEX: Regex match, user agent case insensitive<br/>NOT_REGEX: Regular does not match, user agent case insensitive<br/>START_WITH: Starts with, user agent case insensitive<br/>END_WITH: Ends with, user agent case insensitive<br/>WILDCARD: Wildcard matches, user agent case insensitive, * represents zero or more arbitrary characters, ? represents any single character<br/>NOT_WILDCARD: Wildcard does not match, user agent case insensitive, * represents zero or more arbitrary characters, ? represents any single character
- `referer` (List of String) Referer.<br/>When the match type is REGEX/NOT_REGEX, only one value is allowed. <br/>Example: http://test.com.


<a id="nestedblock--condition--ua_conditions"></a>
### Nested Schema for `condition.ua_conditions`

Required:

- `match_type` (String) Match type.EQUAL: Equals, user agent Match type.<br/>EQUAL: Equals, user agent case sensitive<br/>NOT_EQUAL: Does not equal, user agent case sensitive<br/>CONTAIN: Contains, user agent case insensitive<br/>NOT_CONTAIN: Does not Contains, user agent case insensitive<br/>NONE:Empty or non-existent<br/>REGEX: Regex match, user agent case insensitive<br/>NOT_REGEX: Regular does not match, user agent case insensitive<br/>START_WITH: Starts with, user agent case insensitive<br/>END_WITH: Ends with, user agent case insensitive<br/>WILDCARD: Wildcard matches, user agent case insensitive, * represents zero or more arbitrary characters, ? represents any single character<br/>NOT_WILDCARD: Wildcard does not match, user agent case insensitive, * represents zero or more arbitrary characters, ? represents any single character
- `ua` (List of String) User agent.<br/>When the match type is REGEX/NOT_REGEX, only one value is allowed. <br/>Example: go-Http-client/1.1.


<a id="nestedblock--condition--uri_conditions"></a>
### Nested Schema for `condition.uri_conditions`

Required:

- `match_type` (String) Match type.<br/>EQUAL: Equals, user agent case sensitive<br/>NOT_EQUAL: Does not equal, user agent case sensitive<br/>CONTAIN: Contains, user agent case insensitive<br/>NOT_CONTAIN: Does not Contains, user agent case insensitive<br/>REGEX: Regex match, user agent case insensitive<br/>NOT_REGEX: Regular does not match, user agent case insensitive<br/>START_WITH: Starts with, user agent case insensitive<br/>END_WITH: Ends with, user agent case insensitive<br/>WILDCARD: Wildcard matches, user agent case insensitive, * represents zero or more arbitrary characters, ? represents any single character<br/>NOT_WILDCARD: Wildcard does not match, user agent case insensitive, * represents zero or more arbitrary characters, ? represents any single character
- `uri` (List of String) URI.<br/>When match type is EQUAL/NOT_EQUAL/START_WITH/END_WITH, uri needs to start with "/", and includes parameters.<br/>When the match type is REGEX/NOT_REGEX, only one value is allowed. <br/>Example: /test.html?id=1.


<a id="nestedblock--condition--uri_param_conditions"></a>
### Nested Schema for `condition.uri_param_conditions`

Required:

- `match_type` (String) Match type.<br/>EQUAL:Equals<br/>NOT_EQUAL:Does not equal<br/>CONTAIN:Contains<br/>NOT_CONTAIN:Does not contains<br/>REGEX:Regex match<br/>NONE:Empty or non-existent
- `param_name` (String) Param name,case sensitive,maximum 100 characters.<br/>Example: id.
- `param_value` (List of String) Param value.

<a id="nestedblock--condition--ja3_conditions"></a>
### Nested Schema for `condition.ja3_conditions`

Optional:

- `ja3_list` (List of String) JA3 Fingerprint List, maximum 300 JA3 Fingerprint.<br/>
  When the match type is EQUAL/NOT_EQUAL, each item's character length must be 32 and can only include numbers and lowercase letters.
- `match_type` (String) Match type.<br/>
  EQUAL: Equals<br/>
  NOT_EQUAL: Does not equal


<a id="nestedblock--condition--ja4_conditions"></a>
### Nested Schema for `condition.ja4_conditions`

Optional:

- `ja4_list` (List of String) JA4 Fingerprint List, maximum 300 JA4 Fingerprint.<br/>
  When the match type is EQUAL/NOT_EQUAL, each item's format must be 10 characters + 12 characters + 12 characters, separated by underscores, and can only include underscores, numbers, and lowercase letters.<br/>
  When the match type is CONTAIN/NOT_CONTAIN/START_WITH/END_WITH, each item is only allowed to include underscores, numbers, and lowercase letters.<br/>
  When the match type is WILDCARD/NOT_WILDCARD, each item, aside from  ** and ?, is only allowed to include underscores, numbers, and lowercase letters.<br/>
- `match_type` (String) Match type.<br/>
  EQUAL: Equals<br/>
  NOT_EQUAL: Does not equal<br/>
  CONTAIN: Contains<br/>
  NOT_CONTAIN: Does not Contains<br/>
  START_WITH: Starts with<br/>
  END_WITH: Ends with<br/>
  WILDCARD: Wildcard matches, ** represents zero or more arbitrary characters, ? represents any single character<br/>
  NOT_WILDCARD: Wildcard does not match, ** represents zero or more arbitrary characters, ? represents any single character
